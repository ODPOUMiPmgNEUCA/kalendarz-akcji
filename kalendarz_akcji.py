# -*- coding: utf-8 -*-
"""Kalendarz_akcji.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1bfU5lwdNa2GOPWmQ9-URaf30VnlBzQC0
"""

#importowanie potrzebnych bibliotek
import os
import openpyxl
import streamlit as st
import pandas as pd
import numpy as np
import altair as alt
import plotly.express as px
import plotly.graph_objects as go
from urllib.request import urlopen
import json
import io
import datetime



st.set_page_config(page_title='Kalendarz akcji', layout='wide')



tabs_font_css = """
<style>
div[class*="stTextInput"] label {
  font-size: 26px;
  color: black;
}
div[class*="stSelectbox"] label {
  font-size: 26px;
  color: black;
}
</style>
"""

st.title("Kalendarz akcji")


df_k = st.file_uploader(
    label="Wrzucam se ich syf"
)

if df_k:
    df_k = pd.read_excel(df_k)
    st.write(df_k.head())

    # Konwersja kolumn dat
    df_k['start'] = pd.to_datetime(df_k['start'])
    df_k['koniec'] = pd.to_datetime(df_k['koniec'])

    # Tworzymy timeline
    fig = px.timeline(
        df_k,
        x_start="start",
        x_end="koniec",
        y="akcja",
        color="akcja"
    )

    fig.update_yaxes(autorange="reversed")

    fig.update_layout(
        title="ðŸ“Š Harmonogram akcji",
        xaxis_title="Data",
        yaxis_title="Akcja",
        legend_title="Akcje",
        bargap=0.3
    )

    st.plotly_chart(fig, use_container_width=True)
