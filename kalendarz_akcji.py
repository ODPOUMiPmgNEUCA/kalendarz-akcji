# -*- coding: utf-8 -*-
"""Kalendarz_akcji.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1bfU5lwdNa2GOPWmQ9-URaf30VnlBzQC0
"""

#importowanie potrzebnych bibliotek
import os
import openpyxl
import streamlit as st
import pandas as pd
import numpy as np
from streamlit_calendar import calendar

st.set_page_config(page_title='Kalendarz akcji', layout='wide')

# CSS dla ≈Çadniejszej czcionki i kolor√≥w
st.markdown("""
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

    body, .css-18e3th9 {
        font-family: 'Roboto', sans-serif;
    }

    /* Nag≈Ç√≥wek kalendarza */
    .fc-toolbar-title {
        font-size: 28px !important;
        font-weight: 700 !important;
        color: #2C3E50;
    }

    /* Przyciski w kalendarzu */
    .fc-button {
        background-color: #3498DB !important;
        border: none !important;
        border-radius: 6px !important;
        padding: 6px 12px !important;
        font-size: 14px !important;
        font-weight: 600;
        color: white !important;
    }

    /* Hover na przyciski */
    .fc-button:hover {
        background-color: #2980B9 !important;
    }

    /* Eventy ‚Äì zaokrƒÖglone */
    .fc-event {
        border-radius: 8px !important;
        padding: 4px 6px !important;
        font-size: 14px !important;
        font-weight: 500;
    }

    /* Weekendy ‚Äì delikatne t≈Ço */
    .fc-day-sat, .fc-day-sun {
        background-color: #F8F9FA;
    }

    </style>
""", unsafe_allow_html=True)

st.title("üìÖ Kalendarz akcji")

uploaded_file = st.file_uploader("Wczytaj plik Excel z akcjami", type=["xlsx"])

if uploaded_file:
    df = pd.read_excel(uploaded_file)
    st.write("PodglƒÖd danych:")
    st.dataframe(df.head())

    df["Data startu"] = pd.to_datetime(df["Data startu"])
    df["Data ko≈Ñca"] = pd.to_datetime(df["Data ko≈Ñca"])

    colors = ["#FF6F61", "#6B5B95", "#88B04B", "#F7CAC9", "#92A8D1",
              "#FFB347", "#E6B0AA", "#48C9B0", "#B565A7", "#009B77",
              "#DD4124", "#45B8AC", "#EFC050", "#5B5EA6", "#9B2335",
              "#DFCFBE", "#55B4B0", "#E15D44", "#7FCDCD", "#BC243C"]

    unique_names = df["Nazwa akcji"].unique()
    color_map = {name: colors[i % len(colors)] for i, name in enumerate(unique_names)}

    events = []
    for _, row in df.iterrows():
        event = {
            "start": row["Data startu"].strftime("%Y-%m-%d"),
            "end": row["Data ko≈Ñca"].strftime("%Y-%m-%d"),
            "title": row["Nazwa akcji"],
            "color": color_map[row["Nazwa akcji"]],
        }
        events.append(event)

    # üî• Opcje FullCalendar ‚Äì robimy ‚Äûwypasiony‚Äù wyglƒÖd
    calendar_options = {
        "initialView": "dayGridMonth",
        "headerToolbar": {
            "left": "prev,next today",
            "center": "title",
            "right": "dayGridMonth,timeGridWeek,timeGridDay"  # zmiana widoku
        },
        "height": 750,
        "contentHeight": "auto",
        "aspectRatio": 1.5,
        "navLinks": True,         # klikalne dni/tygodnie
        "editabl
